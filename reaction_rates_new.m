function dz = reaction_rates_new(t,z,A,Ainv)
C=A*z;
dz=Ainv*reaction_rates_original(t,C);
function dC =reaction_rates_original(t,C)
dC = zeros(34,1);

k1 = 3.1E-03;
k2 = 3.2E+06;
k3 = 3.1E-03;
k4 = 2.3E+07;
k5 = 4.4E+05;
 
k6 = 1.3E+07;
k7 = 2.3E+04;
 
k8 = 1.05E+00;
k9 = 2.5E+07;
k10 = 6.0E+00;
k11 = 19.0E+00;
k12 = 2.2E+07;
k13 = 2.4E+00;
k14 = 1.0E+07;
k15 = 1.8E+00;
k16 = 7.5E+03;
k17 = 2.0E+07;
k18 = 5.0E-03;
k19 = 1.0E+07;
k20 = 1.0E-03;
k21 = 1.0E+08;
k22 = 8.2E+00;
k23 = 2.2E+04;
k24 = 6.0E-03;
k25 = 1.0E-03;
k26 = 2.0E+07;
k27 = 0.2E+00;
k28 = 4.0E+08;
k29 = 103.0E+00;
k30 = 1.0E+08;
k31 = 63.5E+00;
k32 = 1.5E+07;
k33 = 3.6E-04;
k34 = 9.0E+05;
k35 = 1.1E-04;
k36 = 3.2E+08;
k37 = 5.0E+07; 
k38 = 1.5E+03;
k39 = 7.1E+03; 
k40 = 4.9E+02; 
k41 = 7.1E+03; 
k42 = 2.3E+02; 
% 
% % From Danforth's Blood Coagulation Sensitivity paper
% % k43 = 5.7E+03;
% % k44 = 3.0E+06;
k43 = 0;
k44 = 0;



dC(1,1) = -k2*C(1)*C(2) + k1*C(3) - k4*C(1)*C(4) + k3*C(5);
dC(2,1) = -k2*C(1)*C(2) + k1*C(3) - k5*C(5)*C(2) - k6*C(6)*C(2) - k7*C(7)*C(2);
dC(3,1) = -k1*C(3) + k2*C(1)*C(2);
dC(4,1) = -k4*C(1)*C(4) + k3*C(5) + k5*C(5)*C(2) + k6*C(6)*C(2) + k7*C(7)*C(2);
dC(5,1) = -k3*C(5) + k4*C(1)*C(4) - k9*C(5)*C(8) + k8*C(9)...
    -k12*C(5)*C(6) + k11*C(10) - k14*C(5)*C(11) + k13*C(12)...
    +k15*C(12) - k37*C(5)*C(27) - k42*C(5)*C(29);
dC(6,1) = -k12*C(5)*C(6) + k11*C(10) + k22*C(18) - k28*C(6)*C(22)...
    +k27*C(23) - k34*C(6)*C(26) + k33*C(27) - k38*C(6)*C(29)...
    +k43*C(13)*C(8);
dC(7,1) = k16*C(6)*C(14) + k32*C(25)*C(23) - k41*C(7)*C(29);
dC(8,1) = -k9*C(5)*C(8) + k8*C(9) - k21*C(17)*C(8) + k20*C(18)...
    +k25*C(18) - k43*C(13)*C(8);
dC(9,1) = k9*C(5)*C(8) - k10*C(9) - k8*C(9);
dC(10,1) = k10*C(9) + k12*C(5)*C(6) - k11*C(10) - k36*C(10)*C(26)...
    +k35*C(28);
dC(11,1) = -k14*C(5)*C(11) + k13*C(12);
dC(12,1) = k14*C(5)*C(11) - k13*C(12) -k15*C(12);
dC(13,1) = k15*C(12) - k19*C(16)*C(13) + k18*C(17) + k25*C(18) ...
    +k25*C(17) - k40*C(13)*C(29);
dC(14,1) = -k16*C(6)*C(14) - k30*C(23)*C(14) + k29*C(24);
dC(15,1) = -k17*C(7)*C(15);
dC(16,1) = k17*C(7)*C(15) - k19*C(16)*C(13) + k18*C(17) - k24*C(16)...
    +k23*C(19)*C(20);
dC(17,1) = k19*C(16)*C(13) - k18*C(17) - k21*C(17)*C(8) + k20*C(18)...
    +k22*C(18) - k25*C(17);
dC(18,1) = k21*C(17)*C(8) - k20*C(18) - k22*C(18) - k25*C(18);
dC(19,1) = k24*C(16) + k25*C(18) + k25*C(17) - k23*C(19)*C(20);
dC(20,1) = k24*C(16) + k25*C(18) + k25*C(17) - k23*C(19)*C(20);
dC(21,1) = -k26*C(7)*C(21) - k44*C(25)*C(21);
dC(22,1) = k26*C(7)*C(21) - k28*C(6)*C(22) + k27*C(23) + k44*C(25)*C(21);
dC(23,1) = k28*C(6)*C(22) - k27*C(23) - k30*C(23)*C(14) + k29*C(24)...
    +k31*C(24);
dC(24,1) = k30*C(23)*C(14) - k29*C(24) - k31*C(24);
dC(25,1) = k31*C(24) - k32*C(25)*C(23) - k39*C(25)*C(29);
dC(26,1) = -k34*C(6)*C(26) + k33*C(27) - k36*C(10)*C(26) + k35*C(28);
dC(27,1) = k34*C(6)*C(26) - k33*C(27) - k37*C(5)*C(27);
dC(28,1) = k36*C(10)*C(26) - k35*C(28) + k37*C(5)*C(27);
dC(29,1) = -k38*C(6)*C(29) - k39*C(25)*C(29) - k40*C(13)*C(29) ...
    -k41*C(7)*C(29) - k42*C(5)*C(29);
dC(30,1) = k38*C(6)*C(29);
dC(31,1) = k39*C(25)*C(29);
dC(32,1) = k40*C(13)*C(29);
dC(33,1) = k41*C(7)*C(29);
dC(34,1) = k42*C(5)*C(29);
end

end
